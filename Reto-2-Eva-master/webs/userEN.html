<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasa Real Estate</title>
    <link rel="stylesheet" href="../estilos/estiloweb.css">
</head>

<body>

    <div class="layout-grid">

        <header>
            <div class="logo-box">
                <img src="../images/logoDefinitivo.png" alt="Logo">
            </div>

            <div class="header-right">
                <!-- Bot√≥n Soy Propietario abre su propio modal -->
                <button class="btn-prop" onclick="window.location.href='#login-owner'">Im an Owner</button>

                <button class="circle-btn flag-btn" onclick="toggleLangModal()">
                    <img src="../images/UKflag.jpg" alt="EN">
                </button>

                <!-- Account button with dropdown menu -->
                <div class="dropdown" id="accountDropdown">
                    <div class="circle-btn" style="display:flex; align-items:center; justify-content:center;">
                        Account
                    </div>
                    <div class="dropdown-content small-menu" id="accountMenu">
                        <a href="#profile">Profile</a>
                        <a href="#" onclick="logOut(); return false;">Log out</a>
                    </div>
                </div>
            </div>
        </header>

        <aside class="sidebar-filtros">

            <div class="sidebar-header">
                <h3>Filters</h3>
            </div>

            <div class="filtro-grupo">
                <label>Area</label>
                <div class="input-wrapper">
                    <span class="icono-input">üìç</span>
                    <select id="filter-zona" onchange="applyFilters()">
                        <option value="todas">All</option>
                        <option value="centro">Center</option>
                        <option value="norte">North</option>
                        <option value="sur">South</option>
                    </select>
                </div>
            </div>

            <div class="filtro-grupo">
                <label>Max Price</label>
                <div class="input-wrapper">
                    <span class="icono-input">‚Ç¨</span>
                    <input type="number" id="filter-precio" placeholder="Ex: 1000" oninput="applyFilters()">
                </div>
            </div>

            <div class="filtro-grupo">
                <label>Type</label>
                <div class="input-wrapper">
                    <span class="icono-input">üè†</span>
                    <select id="filter-tipo" onchange="applyFilters()">
                        <option value="todos">All</option>
                        <option value="piso">Apartment</option>
                        <option value="casa">House</option>
                        <option value="estudio">Studio</option>
                    </select>
                </div>
            </div>

            <button class="btn-limpiar" onclick="clearFilters()">
                Clear Filters
            </button>

        </aside>


        <!--LOS PISOS Y CASAS-->
        <main>
            <div class="property-card" data-zona="sur" data-precio="980" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-flotante izq" onclick="moverGaleria(event, this, -1)">‚ùÆ</button>
                    <div class="galeria">
                        <img src="../images/piso21.png" alt="Modern new kitchen">
                        <img src="../images/piso21.1.png" alt="Italian-style shower bathroom">
                        <img src="../images/piso21.2.png" alt="Bright bedroom">
                    </div>
                    <button class="btn-flotante der" onclick="moverGaleria(event, this, 1)">‚ùØ</button>
                    <button class="btn-reservar" onclick="window.location.href='reserva.html'">
                        Book now
                    </button>
                </div>
                <div class="card-info">
                    <div class="price">‚Ç¨980</div>
                    <div class="location">Brand new renovated</div>
                    <span class="ver-detalles" onclick="openModal(this.closest('.property-card'))">View details</span>
                    <div class="features">
                        <span>3 Beds</span><span>95m¬≤</span>
                    </div>
                </div>
            </div>
        </main>

    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>Kasa</h3>
                <p>Your trusted place to find your next stay.</p>
            </div>
            <div class="footer-column">
                <h3>Explore</h3>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                    <a href="#">Home</a>
                    <a href="#">Stays</a>
                    <a href="#login-owner">Become a host</a>
                    <a href="#login">My account</a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Support</h3>
                <p>üìß support@kasa.com | üìû +34 900 123 456</p>
                <div class="social-links">
                    <a href="#" class="social-icon">üì∑</a>
                    <a href="#" class="social-icon">üê¶</a>
                    <a href="#" class="social-icon">üìò</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 Kasa.</p>
            <div style="display:flex; gap:10px;">
                <a href="#">Terms</a>
                <a href="#">Privacy</a>
            </div>
        </div>
    </footer>



    <!-- Modal de Propiedad -->
    <div id="propertyModal" class="modal-fondo">
        <div class="modal-contenido-grande">

            <div class="modal-col-izq">
                <button class="btn-flotante izq" onclick="moverGaleriaModal(-1)"
                    style="left:15px; background:rgba(255,255,255,0.3); color:white; border:none;">‚ùÆ</button>

                <div id="modal-img-container" style="width:100%; height:100%; display:flex; overflow:hidden;">
                </div>

                <button class="btn-flotante der" onclick="moverGaleriaModal(1)"
                    style="right:15px; background:rgba(255,255,255,0.3); color:white; border:none;">‚ùØ</button>
            </div>

            <div class="modal-col-der">
                <span class="cerrar-modal-x" onclick="closeModal()">√ó</span>

                <h2 id="modal-title" style="color:#2c3e50; font-size:26px; margin-bottom:5px;">Title</h2>
                <div id="modal-location" style="color:#777; margin-bottom:15px;">Location</div>

                <div id="modal-price" style="font-size:32px; font-weight:bold; color:#17a2b8; margin-bottom:20px;">‚Ç¨0
                </div>

                <div id="modal-features" class="features" style="border:none; padding:0; margin-bottom:20px;"></div>

                <div style="flex:1; overflow-y:auto; margin-bottom:20px;">
                    <p id="modal-description-text" style="color:#555; line-height:1.6;">
                        Property description...
                    </p>
                </div>

                <div style="display:flex; gap:10px;">
                    <button onclick="toggleCalendario()"
                        style="flex:1; padding:12px; background:#2c3e50; color:white; border:none; border-radius:6px; cursor:pointer;">
                        Check availability
                    </button>
                    <button onclick="window.location.href='reserva.html'"
                        style="flex:1; padding:12px; background:#17a2b8; color:white; border:none; border-radius:6px; cursor:pointer;">
                        Book now
                    </button>
                </div>

                <div id="calendario-reserva" class="calendario-reserva" style="display: none;">
                    <div class="calendario-header">
                        <button onclick="cambiarMes(-1)" style="cursor:pointer;">‚ùÆ</button>
                        <span id="mes-actual">January 2026</span>
                        <button onclick="cambiarMes(1)" style="cursor:pointer;">‚ùØ</button>
                    </div>
                    <div class="grid-dias" id="grid-dias"></div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Modal de Idioma -->
    <div id="langModal" class="lang-modal-overlay" onclick="closeLangModal(event)">
        <div class="lang-modal-content">
            <div class="lang-modal-header">
                <h3>Select your language</h3>
                <button class="close-modal-btn" onclick="toggleLangModal()">√ó</button>
            </div>
            <div class="lang-list">
                <a href="webES.html" class="lang-option">
                    <img src="../images/ESflag.jpg" class="lang-flag" alt="ES">
                    <span>Espa√±ol</span>
                </a>
                <div class="lang-option active">
                    <img src="../images/UKflag.jpg" class="lang-flag" alt="UK">
                    <span>English (UK)</span>
                    <span class="check-icon">‚úì</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login -->
    <div id="login" class="modal-fondo">
        <div class="modal-login-content">
            <a href="#" class="cerrar">‚úï</a>
            <h2>Log in</h2>
            <form
                onsubmit="event.preventDefault(); alert('Sesi√≥n iniciada correctamente'); window.location.href='userEN.html';">
                <input type="email" name="email" placeholder="Email" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Enter</button>
            </form>
            <p>Don't have an account yet? <a href="#registro">Sign up</a></p>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div id="registro" class="modal-fondo">
        <div class="modal-login-content">
            <a href="#" class="cerrar">‚úï</a>
            <h2>Sign up</h2>
            <form
                onsubmit="event.preventDefault(); alert('Cuenta creada correctamente. Ahora puedes iniciar sesi√≥n.'); window.location.href='#login';">
                <input type="text" name="nombre" placeholder="Name" required>
                <input type="email" name="email" placeholder="Email" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Sign up</button>
            </form>
            <p>Already have an account? <a href="#login">Log in</a></p>
        </div>
    </div>

    <!-- Modal de Login Propietario -->
    <div id="login-owner" class="modal-fondo owner-modal">
        <div class="modal-login-content">
            <a href="#" class="cerrar">‚úï</a>
            <h2 style="color: #2c3e50;">Owner Access</h2>
            <form
                onsubmit="event.preventDefault(); alert('Acceso concedido'); window.location.href='propietarioEN.html';">
                <input type="email" name="email" placeholder="Corporate Email" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Enter</button>
            </form>
            <p>Authorized personnel only.</p>
        </div>
    </div>

    <!--SCRIPT-->

    <script>
        function toggleLangModal() {
            const modal = document.getElementById('langModal');
            modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
        }

        function closeLangModal(e) {
            if (e.target.id === 'langModal') {
                toggleLangModal();
            }
        }

        // 1. FILTROS
        function applyFilters() {
            const zona = document.getElementById('filter-zona').value.toLowerCase();
            const precioMax = parseFloat(document.getElementById('filter-precio').value) || Infinity;
            const tipo = document.getElementById('filter-tipo').value.toLowerCase();

            document.querySelectorAll('.property-card').forEach(card => {
                const cZona = card.getAttribute('data-zona') || "";
                const cPrecio = parseFloat(card.getAttribute('data-precio')) || 0;
                const cTipo = card.getAttribute('data-tipo') || "";

                let show = true;
                if (zona !== 'todas' && cZona !== zona) show = false;
                if (cPrecio > precioMax) show = false;
                if (tipo !== 'todos' && cTipo !== tipo) show = false;

                card.style.display = show ? 'flex' : 'none';
            });
        }

        function clearFilters() {
            document.getElementById('filter-zona').value = 'todas';
            document.getElementById('filter-precio').value = '';
            document.getElementById('filter-tipo').value = 'todos';
            applyFilters();
        }

        // 2. GALERIA DE LAS TARJETAS (Peque√±a)
        function moverGaleria(e, btn, dir) {
            e.stopPropagation(); // Evita que se abra el modal al hacer click en flechas
            const container = btn.parentElement.querySelector('.galeria');
            container.scrollBy({ left: dir * 300, behavior: 'smooth' });
        }

        // 3. LOGICA DEL MODAL DE DETALLES
        const modal = document.getElementById("propertyModal");

        function openModal(card) {
            // Sacar datos de la tarjeta clickeada
            const title = card.querySelector('.location').innerText;
            const price = card.querySelector('.price').innerText;
            const features = card.querySelector('.features').innerHTML;

            // Llenar el modal
            document.getElementById("modal-title").innerText = title;
            document.getElementById("modal-location").innerText = title; // Repetimos titulo en location por simplicidad
            document.getElementById("modal-price").innerText = price;
            document.getElementById("modal-features").innerHTML = features;

            document.getElementById("modal-description-text").innerText =
                `This magnificent property in ${title} has all the amenities. ` +
                `For a price of ${price}, it is a unique opportunity. Contact us to visit it.`;

            // Clonar im√°genes
            const modalImgs = document.getElementById("modal-img-container");
            modalImgs.innerHTML = ''; // Limpiar anteriores
            const images = card.querySelectorAll('.galeria img');
            images.forEach(img => {
                let clone = img.cloneNode();
                clone.style.minWidth = "100%"; // Asegurar que ocupen todo el modal
                modalImgs.appendChild(clone);
            });

            // Mostrar modal
            modal.style.display = "flex";
            document.body.style.overflow = "hidden"; // Bloquear scroll del fondo
        }

        function closeModal() {
            modal.style.display = "none";
            document.body.style.overflow = "auto";
        }

        // Cerrar si click fuera del contenido
        window.onclick = function (event) {
            if (event.target == modal) {
                closeModal();
            }
        }

        // Galer√≠a dentro del modal
        function moverGaleriaModal(dir) {
            const container = document.getElementById("modal-img-container");
            const w = container.offsetWidth;
            container.scrollBy({ left: dir * w, behavior: 'smooth' });
        }

        // 4. CALENDARIO SIMPLE
        let currentMonth = 0; // Enero
        function toggleCalendario() {
            const cal = document.getElementById("calendario-reserva");
            cal.style.display = (cal.style.display === "none") ? "block" : "none";
            if (cal.style.display === "block") renderCalendario();
        }

        function renderCalendario() {
            const grid = document.getElementById("grid-dias");
            grid.innerHTML = "";
            // Generar 30 dias dummy
            for (let i = 1; i <= 30; i++) {
                let d = document.createElement("div");
                d.className = "day";
                d.innerText = i;
                if (i % 5 === 0) d.classList.add("occupied"); // Dummy ocupados
                else {
                    d.onclick = function () { this.classList.toggle("selected"); }
                }
                grid.appendChild(d);
            }
        }
        function cambiarMes(d) {
            // Solo cambia el texto por efecto visual
            const meses = ["Jan", "Feb", "Mar", "Apr"];
            let m = document.getElementById("mes-actual");
            m.innerText = "Next month...";
        }

        // Function to log out
        function logOut() {
            if (confirm('Are you sure you want to log out?')) {
                alert('Logged out successfully');
                window.location.href = 'webEN.html'; // Redirect to main page
            }
        }

        // Improved dropdown menu control
        let menuTimeout;
        const dropdown = document.getElementById('accountDropdown');
        const menu = document.getElementById('accountMenu');

        if (dropdown && menu) {
            // Show menu when hovering over dropdown
            dropdown.addEventListener('mouseenter', function () {
                clearTimeout(menuTimeout);
                menu.classList.add('show');
            });

            // Hide menu with delay when leaving
            dropdown.addEventListener('mouseleave', function () {
                menuTimeout = setTimeout(function () {
                    menu.classList.remove('show');
                }, 300); // 300ms delay before closing
            });
        }

    </script>
</body>

</html>