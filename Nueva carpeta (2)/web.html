<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inmobiliaria - Alquiler</title>
    <link rel="stylesheet" href="./estilos/estiloweb.css">
</head>
<body>

    <div class="layout-grid">

        <header>
            <div class="logo-box">
                <img src="./images/logoDefinitivo.png" alt="Logo Inmobiliaria" class="logo-img">
             </div>
            <div class="dropdown">
        <button class="main-title-pill dropdown-btn">Alquileres ‚ñæ</button>
        <div class="dropdown-content">
            <a href="#">Pisos</a>
            <a href="#">Casas</a>
        </div>
    </div>

    <div class="header-right">
        <button class="btn-prop">Soy Propietario</button>
        
        <div class="dropdown">
            <div class="circle-btn dropdown-btn">ES</div>
            <div class="dropdown-content small-menu">
                <a href="#">Espa√±ol</a>
                <a href="#">Ingl√©s</a>
            </div>
        </div>

        <div class="dropdown">
            <a href="/login/inicio.html" class="circle-btn dropdown-btn">Cuenta</a>
        </div>
    </div>
</header>

        <aside class="sidebar">
            <div class="filter-pill">
                <div class="filter-option">
                    <span class="filter-label">Ciudad</span>
                    <select id="filter-ciudad" onchange="applyFilters()">
                        <option value="todas">Todas</option>
                        <option value="donosti">Donosti</option>
                        <option value="madrid">Madrid</option>
                        <option value="barcelona">Barcelona</option>
                        <option value="valencia">Valencia</option>
                        <option value="murcia">Murcia</option>
                        <option value="valladolid">Valladolid</option>
                    </select>
                </div>
                <div class="filter-option">
                    <span class="filter-label">Zona</span>
                    <select id="filter-zona" onchange="applyFilters()">
                        <option value="todas">Todas</option>
                        <option value="centro">Centro</option>
                        <option value="norte">Norte</option>
                        <option value="sur">Sur</option>
                        <option value="costa">Costa</option>
                        <option value="pueblo">Pueblo</option>
                        <option value="monta√±a">Monta√±a</option>
                    </select>
                </div>
                <div class="filter-option">
                    <span class="filter-label">Precio M√°x</span>
                    <input type="number" id="filter-precio" placeholder="Ej: 1000" oninput="applyFilters()">
                </div>
                <div class="filter-option">
                    <span class="filter-label">Tipo</span>
                    <select id="filter-tipo" onchange="applyFilters()">
                        <option value="todos">Todos</option>
                        <option value="piso">Piso</option>
                        <option value="casa">Casa</option>
                        <option value="estudio">Estudio</option>
                        <option value="atico">√Åtico</option>
                        <option value="loft">Loft</option>
                        <option value="villa">Villa</option>
                        <option value="duplex">D√∫plex</option>
                        <option value="bungalow">Bungalow</option>
                    </select>
                </div>
                <div class="filter-option">
                    <button class="btn-clear" onclick="clearFilters()">Limpiar Filtros</button>
                </div>
            </div>
        </aside>

        <main>
            <!-- Repetitive cards updated for navigation and modal -->
            <div class="property-card" onclick="openModal(this)" data-booked="5,6,12" data-ciudad="donosti" data-zona="centro" data-precio="850" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso1.png" alt="Foto 1">
                        <img src="./images/piso1.1.png" alt="Foto 2">
                        <img src="./images/piso1.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">850‚Ç¨</div>
                    <div class="location">Apartamento Centro</div>
                    <div class="features"><span>2 Hab</span><span>65m¬≤</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="10,11,15,16" data-ciudad="madrid" data-zona="centro" data-precio="1200" data-tipo="atico">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso2.png" alt="Foto 1">
                        <img src="./images/piso2.1.png" alt="Foto 2">
                        <img src="./images/piso2.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.200‚Ç¨</div>
                    <div class="location">√Åtico Lujoso</div>
                    <div class="features"><span>3 Hab</span><span>90m¬≤</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="1,2,3,25" data-ciudad="barcelona" data-zona="norte" data-precio="700" data-tipo="estudio">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso3.png" alt="Foto 1">
                        <img src="./images/piso3.1.png" alt="Foto 2">
                        <img src="./images/piso3.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">700‚Ç¨</div>
                    <div class="location">Estudio Vanguardia</div>
                    <div class="features"><span>1 Hab</span><span>40m¬≤</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="20,21,22" data-ciudad="valencia" data-zona="centro" data-precio="950" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso4.png" alt="Foto 1">
                        <img src="./images/piso4.1.png" alt="Foto 2">
                        <img src="./images/piso4.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">950‚Ç¨</div>
                    <div class="location">Piso Hist√≥rico</div>
                    <div class="features"><span>2 Hab</span><span>Exterior</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="14,15,16,17" data-ciudad="murcia" data-zona="sur" data-precio="1500" data-tipo="casa">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso5.png" alt="Foto 1">
                        <img src="./images/piso5.1.png" alt="Foto 2">
                        <img src="./images/piso5.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.500‚Ç¨</div>
                    <div class="location">Adosado Jard√≠n</div>
                    <div class="features"><span>4 Hab</span><span>Garaje</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="8,9,30" data-ciudad="donosti" data-zona="norte" data-precio="600" data-tipo="loft">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso6.png" alt="Foto 1">
                        <img src="./images/piso6.1.png" alt="Foto 2">
                        <img src="./images/piso6.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">600‚Ç¨</div>
                    <div class="location">Loft Industrial</div>
                    <div class="features"><span>1 Hab</span><span>D√∫plex</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="1,2,5,10,20" data-ciudad="madrid" data-zona="sur" data-precio="1100" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso7.png" alt="Foto 1">
                        <img src="./images/piso7.1.png" alt="Foto 2">
                        <img src="./images/piso7.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.100‚Ç¨</div>
                    <div class="location">Piso Familiar Amplio</div>
                    <div class="features"><span>3 Hab</span><span>2 Ba√±os</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="15,16,17,18" data-ciudad="barcelona" data-zona="norte" data-precio="890" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso8.png" alt="Foto 1">
                        <img src="./images/piso8.1.png" alt="Foto 2">
                        <img src="./images/piso8.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">890‚Ç¨</div>
                    <div class="location">Residencia Estudiantes</div>
                    <div class="features"><span>2 Hab</span><span>Amuebl.</span></div>
                </div>
            </div>

             <div class="property-card" onclick="openModal(this)" data-booked="24,25,26" data-ciudad="valencia" data-zona="costa" data-precio="2000" data-tipo="villa">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso9.png" alt="Foto 1">
                        <img src="./images/piso9.1.png" alt="Foto 2">
                        <img src="./images/piso9.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">2.000‚Ç¨</div>
                    <div class="location">Villa Costa Lujo</div>
                    <div class="features"><span>5 Hab</span><span>Piscina</span></div>
                </div>
            </div>

            <!-- NUEVAS CASAS (10-15) -->
            <div class="property-card" onclick="openModal(this)" data-booked="5,10,15,20,25" data-ciudad="murcia" data-zona="norte" data-precio="1300" data-tipo="duplex">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso10.png" alt="Foto 1">
                        <img src="./images/piso10.1.png" alt="Foto 2">
                        <img src="./images/piso10.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.300‚Ç¨</div>
                    <div class="location">D√∫plex Moderno</div>
                    <div class="features"><span>3 Hab</span><span>Terraza</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="2,3,4,18,19" data-ciudad="donosti" data-zona="pueblo" data-precio="600" data-tipo="casa">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso11.png" alt="Foto 1">
                        <img src="./images/piso11.1.png" alt="Foto 2">
                        <img src="./images/piso11.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">600‚Ç¨</div>
                    <div class="location">Casa de Pueblo</div>
                    <div class="features"><span>2 Hab</span><span>R√∫stico</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="12,13,14,28,29" data-ciudad="madrid" data-zona="costa" data-precio="1800" data-tipo="bungalow">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso12.png" alt="Foto 1">
                        <img src="./images/piso12.1.png" alt="Foto 2">
                        <img src="./images/piso12.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.800‚Ç¨</div>
                    <div class="location">Bungalow Jard√≠n</div>
                    <div class="features"><span>3 Hab</span><span>Playa</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="6,7,8,22,23" data-ciudad="barcelona" data-zona="centro" data-precio="1450" data-tipo="atico">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso13.png" alt="Foto 1">
                        <img src="./images/piso13.1.png" alt="Foto 2">
                        <img src="./images/piso13.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.450‚Ç¨</div>
                    <div class="location">√Åtico Vistas</div>
                    <div class="features"><span>2 Hab</span><span>Lujo</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="1,2,3,15,31" data-ciudad="valencia" data-zona="sur" data-precio="950" data-tipo="loft">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso14.png" alt="Foto 1">
                        <img src="./images/piso14.1.png" alt="Foto 2">
                        <img src="./images/piso14.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">950‚Ç¨</div>
                    <div class="location">Loft Minimalista</div>
                    <div class="features"><span>1 Hab</span><span>Dise√±o</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="10,11,12,13,20,21" data-ciudad="donosti" data-zona="monta√±a" data-precio="2500" data-tipo="villa">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso15.png" alt="Foto 1">
                        <img src="./images/piso15.1.png" alt="Foto 2">
                        <img src="./images/piso15.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">2.500‚Ç¨</div>
                    <div class="location">Villa Monta√±a</div>
                    <div class="features"><span>6 Hab</span><span>Vistas</span></div>
                </div>
            </div>

            <!-- NUEVAS CASAS (16-20) -->
            <div class="property-card" onclick="openModal(this)" data-booked="5,6,19,20" data-ciudad="murcia" data-zona="norte" data-precio="750" data-tipo="piso">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso16.png" alt="Foto 1">
                        <img src="./images/piso16.1.png" alt="Foto 2">
                        <img src="./images/piso16.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">750‚Ç¨</div>
                    <div class="location">Piso Estudiantes</div>
                    <div class="features"><span>3 Hab</span><span>Wifi</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="1,15,30" data-ciudad="valladolid" data-zona="costa" data-precio="850" data-tipo="estudio">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso17.png" alt="Foto 1">
                        <img src="./images/piso17.1.png" alt="Foto 2">
                        <img src="./images/piso17.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">850‚Ç¨</div>
                    <div class="location">Estudio Puerto</div>
                    <div class="features"><span>1 Hab</span><span>Vistas</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="10,11,12,13" data-ciudad="valladolid" data-zona="pueblo" data-precio="1100" data-tipo="casa">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso18.png" alt="Foto 1">
                        <img src="./images/piso18.1.png" alt="Foto 2">
                        <img src="./images/piso18.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.100‚Ç¨</div>
                    <div class="location">Casa Solariega</div>
                    <div class="features"><span>4 Hab</span><span>Patio</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="20,21,22,23,24,25" data-ciudad="madrid" data-zona="centro" data-precio="3000" data-tipo="duplex">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso19.png" alt="Foto 1">
                        <img src="./images/piso19.1.png" alt="Foto 2">
                        <img src="./images/piso19.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">3.000‚Ç¨</div>
                    <div class="location">Penthouse Premium</div>
                    <div class="features"><span>4 Hab</span><span>Piscina</span></div>
                </div>
            </div>

            <div class="property-card" onclick="openModal(this)" data-booked="5,15,25" data-ciudad="barcelona" data-zona="costa" data-precio="1600" data-tipo="bungalow">
                <div class="marco-fotos">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleria(event, this, -1)"> ü°® </button>
                    <div class="galeria">
                        <img src="./images/piso20.png" alt="Foto 1">
                        <img src="./images/piso20.1.png" alt="Foto 2">
                        <img src="./images/piso20.2.png" alt="Foto 3">
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleria(event, this, 1)"> ü°™ </button>
                </div>
                <div class="card-info">
                    <div class="price">1.600‚Ç¨</div>
                    <div class="location">Bungalow Playa</div>
                    <div class="features"><span>3 Hab</span><span>Jard√≠n</span></div>
                </div>
            </div>
        </main>


        <footer>
            Footer Inmobiliaria
        </footer>
    <!-- MODAL DE DETALLES -->
    <div id="propertyModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div class="modal-body">
                <div class="modal-gallery">
                    <button class="btn-nav btn-izquierda" onclick="moverGaleriaModal(-1)"> ü°® </button>
                    <div id="modal-img-container">
                        <!-- Se llena con JS -->
                    </div>
                    <button class="btn-nav btn-derecha" onclick="moverGaleriaModal(1)"> ü°™ </button>
                </div>
                <div class="modal-info">
                    <h2 id="modal-title" class="modal-title">T√≠tulo Propiedad</h2>
                    <div id="modal-location" class="modal-location">Ubicaci√≥n detallada</div>
                    <div id="modal-price" class="modal-price">0.000‚Ç¨</div>
                    <div id="modal-features" class="modal-features">
                        <!-- Caracter√≠sticas aqu√≠ -->
                    </div>
                    <div class="modal-desc">
                        <h3 style="margin-bottom: 10px; color: #2c3e50;">Descripci√≥n</h3>
                        <p id="modal-description-text" style="color: #666; line-height: 1.6;">
                            Cargando descripci√≥n...
                        </p>
                    </div>
                    
                    <!-- BOTONES DE ACCI√ìN -->
                    <div class="modal-btn-container">
                        <button class="btn-calendario" onclick="toggleCalendario()">Ver Disponibilidad</button>
                        <button class="btn-contacto">Reservar</button>
                    </div>

                    <!-- CONTENEDOR DEL CALENDARIO -->
                    <div id="calendario-reserva" class="calendario-reserva" style="display: none;">
                        <div class="calendario-header">
                            <button onclick="cambiarMes(-1)"> ü°® </button>
                            <span id="mes-actual">Enero 2026</span>
                            <button onclick="cambiarMes(1)"> ü°™ </button>
                        </div>
                        <div class="dias-semana">
                            <span>Lu</span><span>Ma</span><span>Mi</span><span>Ju</span><span>Vi</span><span>Sa</span><span>Do</span>
                        </div>
                        <div id="grid-dias" class="grid-dias">
                            <!-- Se llena con JS -->
                        </div>
                        <div class="leyenda">
                            <span class="leyenda-item"><span class="color-box ocupado"></span>Ocupado</span>
                            <span class="leyenda-item"><span class="color-box seleccionado"></span>Tu selecci√≥n</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- NAVEGACI√ìN DE GALER√çA EN CARDS ---
        function moverGaleria(event, boton, direccion) {
            // Evitamos que se abra el modal al pulsar los botones
            if (event) event.stopPropagation();
            
            const contenedor = boton.parentElement.querySelector('.galeria');
            const anchoStep = contenedor.offsetWidth;
            
            contenedor.scrollBy({
                left: direccion * anchoStep,
                behavior: 'smooth'
            });
        }

        // --- L√ìGICA DEL MODAL ---
        const modal = document.getElementById("propertyModal");

        function openModal(card) {
            // Extraemos datos de la card
            const title = card.querySelector('.location').innerText;
            const price = card.querySelector('.price').innerText;
            const location = card.querySelector('.location').innerText;
            const features = card.querySelector('.features').innerHTML;
            const images = card.querySelectorAll('.galeria img');
            const cityRaw = card.getAttribute('data-ciudad') || "";
            const city = cityRaw.charAt(0).toUpperCase() + cityRaw.slice(1);

            // Poblamos el modal con datos reales
            document.getElementById("modal-title").innerText = "Detalle de: " + title;
            document.getElementById("modal-price").innerText = price;
            document.getElementById("modal-location").innerText = "Ciudad: " + city + " | Zona: " + location;
            document.getElementById("modal-features").innerHTML = features;
            document.getElementById("modal-description-text").innerText = "Espectacular " + title + " disponible para alquiler inmediato en la ciudad de " + city + " (zona " + location + "). Cuenta con todas las calidades premium, sistema de climatizaci√≥n avanzado y una distribuci√≥n optimizada para maximizar el espacio y la luz natural.";

            // Limpiamos y clonamos im√°genes
            const modalImgContainer = document.getElementById("modal-img-container");
            modalImgContainer.innerHTML = '';
            
            // Volvemos al principio de la galer√≠a al abrir
            modalImgContainer.scrollTo(0, 0);

            images.forEach(img => {
                const newImg = img.cloneNode();
                modalImgContainer.appendChild(newImg);
            });

            modal.style.display = "block";
            document.body.style.overflow = "hidden"; // Bloquea scroll fondo

            // Reset del calendario
            const dispoWrapper = document.getElementById("calendario-reserva");
            dispoWrapper.style.display = "none";
            const bookedData = card.getAttribute('data-booked') || "";
            currentBookedDays = bookedData.split(',').map(n => parseInt(n));
            renderCalendario();
        }

        // --- L√ìGICA DEL CALENDARIO INTERACTIVO ---
        let currentMonth = 0; // Enero (0-index)
        let currentYear = 2026;
        let currentBookedDays = [];

        function toggleCalendario() {
            const wrapper = document.getElementById("calendario-reserva");
            const btn = document.querySelector(".btn-dispo");
            if (wrapper.style.display === "none") {
                wrapper.style.display = "block";
                renderCalendario();
            } else {
                wrapper.style.display = "none";
            }
        }

        function renderCalendario() {
            const grid = document.getElementById("grid-dias");
            const mesTexto = document.getElementById("mes-actual");
            const date = new Date(currentYear, currentMonth, 1);
            
            const nombresMeses = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            mesTexto.innerText = nombresMeses[currentMonth] + " " + currentYear;

            grid.innerHTML = "";

            // Primer d√≠a del mes (0=Dom, 1=Lun...) -> Ajustamos para que 0 sea Lunes
            let firstDay = new Date(currentYear, currentMonth, 1).getDay();
            firstDay = firstDay === 0 ? 6 : firstDay - 1;

            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

            // Huecos vac√≠os antes del primer d√≠a
            for (let i = 0; i < firstDay; i++) {
                const empty = document.createElement("div");
                grid.appendChild(empty);
            }

            // D√≠as del mes
            for (let day = 1; day <= daysInMonth; day++) {
                const diaElement = document.createElement("div");
                diaElement.classList.add("dia");
                diaElement.innerText = day;

                // Si es un d√≠a ocupado (solo para el mes de Enero 2026 en esta demo)
                if (currentMonth === 0 && currentYear === 2026 && currentBookedDays.includes(day)) {
                    diaElement.classList.add("ocupado");
                    diaElement.title = "Fecha no disponible";
                } else {
                    diaElement.onclick = () => seleccionarDia(diaElement);
                }

                grid.appendChild(diaElement);
            }
        }

        function cambiarMes(delta) {
            currentMonth += delta;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendario();
        }

        function seleccionarDia(el) {
            if (el.classList.contains("seleccionado")) {
                el.classList.remove("seleccionado");
            } else {
                el.classList.add("seleccionado");
            }
        }

        function closeModal() {
            modal.style.display = "none";
            document.body.style.overflow = "auto";
        }

        // Cerrar al clicar fuera
        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }

        // Navegaci√≥n en el modal
        function moverGaleriaModal(direccion) {
            const container = document.getElementById("modal-img-container");
            const step = container.offsetWidth;
            container.scrollBy({
                left: direccion * step,
                behavior: 'smooth'
            });
        }

        // --- NAVEGACI√ìN POR TECLADO ---
        document.addEventListener('keydown', function(event) {
            if (modal.style.display === "block") {
                if (event.key === "ArrowRight") {
                    moverGaleriaModal(1);
                } else if (event.key === "ArrowLeft") {
                    moverGaleriaModal(-1);
                } else if (event.key === "Escape") {
                    closeModal();
                }
            }
        });

        // --- NAVEGACI√ìN AL CLICAR EN IMAGEN DEL MODAL ---
        // --- L√ìGICA DE FILTRADO ---
        function applyFilters() {
            const ciudad = document.getElementById('filter-ciudad').value.toLowerCase();
            const zona = document.getElementById('filter-zona').value.toLowerCase();
            const precioMax = parseFloat(document.getElementById('filter-precio').value) || Infinity;
            const tipo = document.getElementById('filter-tipo').value.toLowerCase();

            const cards = document.querySelectorAll('.property-card');

            cards.forEach(card => {
                const cardCiudad = card.getAttribute('data-ciudad')?.toLowerCase() || "";
                const cardZona = card.getAttribute('data-zona')?.toLowerCase() || "";
                const cardPrecio = parseFloat(card.getAttribute('data-precio')) || 0;
                const cardTipo = card.getAttribute('data-tipo')?.toLowerCase() || "";

                const cumpleCiudad = ciudad === 'todas' || cardCiudad === ciudad;
                const cumpleZona = zona === 'todas' || cardZona === zona;
                const cumplePrecio = cardPrecio <= precioMax;
                const cumpleTipo = tipo === 'todos' || cardTipo === tipo;

                if (cumpleCiudad && cumpleZona && cumplePrecio && cumpleTipo) {
                    card.style.display = "flex";
                } else {
                    card.style.display = "none";
                }
            });
        }

        function clearFilters() {
            document.getElementById('filter-ciudad').value = 'todas';
            document.getElementById('filter-zona').value = 'todas';
            document.getElementById('filter-precio').value = '';
            document.getElementById('filter-tipo').value = 'todos';
            applyFilters();
        }
    </script>
</body>
</html>
